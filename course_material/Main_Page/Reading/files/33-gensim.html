<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>9. gensim &mdash; Scikit, No Tears 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/override.css?v=1c84ae95" />

  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://learn-scikit.oneoffcoder.com/gensim.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f6245a2f"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="_static/thebelab-helper.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"equationNumbers": {"autoNumber": "AMS", "useLabelIds": true}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "tex2jax_ignore|mathjax_ignore|document", "processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="10. PyOD, Anamoly Detection" href="pyod.html" />
    <link rel="prev" title="8. NLTK" href="nltk.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #FF3C00" >

          
          
          <a href="index.html" class="icon icon-home">
            Scikit, No Tears
              <img src="_static/logo-small.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="generate-samples.html">1. Generating Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizing.html">2. Visualizing data</a></li>
<li class="toctree-l1"><a class="reference internal" href="regression.html">3. Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="logistic-regression.html">4. Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="poisson-regression.html">5. Poisson Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification.html">6. Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">7. Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="nearest-neighbors.html">8. Nearest Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="dimension-reduction.html">9. Dimensionality Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairwise-metrics.html">10. Pairwise Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocessing.html">11. Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="imputation.html">12. Imputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipelines.html">13. Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">14. Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyperparam-tuning.html">15. Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-extraction.html">16. Feature Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="feature-selection.html">17. Feature Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="customized-estimators.html">18. Customized Estimators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Plotting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="plot-line.html">1. Line Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-bar.html">2. Bar Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-heatmap.html">3. Heat Map</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-dist.html">4. Distribution Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-box.html">5. Box Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-area.html">6. Area Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-pie.html">7. Pie Chart</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-scatter.html">8. Scatter Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-parallel-coordinates.html">9. Parallel Coordinates</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-graph.html">10. Graph Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-mosaic.html">11. Mosiac Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="plot-animation.html">12. Animations</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Supporting APIs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pandas.html">1. Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="dask.html">2. Dask</a></li>
<li class="toctree-l1"><a class="reference internal" href="widgets.html">3. Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="patsy.html">4. Patsy</a></li>
<li class="toctree-l1"><a class="reference internal" href="statsmodels.html">5. statsmodels</a></li>
<li class="toctree-l1"><a class="reference internal" href="shap.html">6. SHAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="imbalanced-learn.html">7. imbalanced-learn</a></li>
<li class="toctree-l1"><a class="reference internal" href="nltk.html">8. NLTK</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">9. gensim</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Topic-modeling">9.1. Topic modeling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Visualize-document-vectors">9.1.1. Visualize document vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Print-word-to-topic-relevance">9.1.2. Print word to topic relevance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-coherence">9.1.3. Check coherence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Check-clustering-quality">9.1.4. Check clustering quality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#word2vec">9.2. word2vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#doc2vec">9.3. doc2vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Word-mover's-distance">9.4. Word mover’s distance</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pyod.html">10. PyOD, Anamoly Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="combo.html">11. combo</a></li>
<li class="toctree-l1"><a class="reference internal" href="pygam.html">12. pyGAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="rpy2.html">13. rpy2</a></li>
<li class="toctree-l1"><a class="reference internal" href="mlflow.html">14. MLflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="optuna.html">15. optuna</a></li>
<li class="toctree-l1"><a class="reference internal" href="xgboost.html">16. XGBoost</a></li>
<li class="toctree-l1"><a class="reference internal" href="lightgbm.html">17. LightGBM</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tips.html">1. Tips</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #FF3C00" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Scikit, No Tears</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">9. </span>gensim</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gensim">
<h1><span class="section-number">9. </span>gensim<a class="headerlink" href="#gensim" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://radimrehurek.com/gensim/">Gensim</a> is a topic modeling API. However, gensim also has the ability to create word and document embeddings. Below is a dataset of book titles dealing with two “topics”, one for “data science” and the other for “finance”. We will use this dataset to see how gensim can be used to learn and recover topics.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;Data Science from Scratch: First Principles with Python&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Data Science for Business: What You Need to Know about Data Mining and Data-Analytic Thinking&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Practical Statistics for Data Scientists&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Build a Career in Data Science&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Python Data Science Handbook&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Storytelling with Data: A Data Visualization Guide for Business Professionals&#39;</span><span class="p">,</span>
        <span class="s1">&#39;R for Data Science: Import, Tidy, Transform, Visualize, and Model Data&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Data-Driven Science and Engineering: Machine Learning, Dynamical Systems, and Control&#39;</span><span class="p">,</span>
        <span class="s1">&#39;A Hands-On Introduction to Data Science&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Intro to Python for Computer Science and Data Science: Learning to Program with AI, Big Data and The Cloud&#39;</span><span class="p">,</span>
        <span class="s1">&#39;How Finance Works: The HBR Guide to Thinking Smart About the Numbers&#39;</span><span class="p">,</span>
        <span class="s1">&#39;The Intelligent Investor: The Definitive Book on Value Investing. A Book of Practical Counsel&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Introduction to Finance: Markets, Investments, and Financial Management&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Python for Finance: Mastering Data-Driven Finance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;The Infographic Guide to Personal Finance: A Visual Reference for Everything You Need to Know&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Personal Finance For Dummies&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Corporate Finance For Dummies&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Lords of Finance: The Bankers Who Broke the World&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Real Estate Finance &amp; Investments&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Real Estate Finance and Investments Risks and Opportunities&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;clazz&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="p">})</span>

<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(20, 2)
</pre></div></div>
</div>
<p>We have to tokenize, lemmatize and remove stop words from the original text.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="kn">from</span> <span class="nn">nltk.stem</span> <span class="kn">import</span> <span class="n">WordNetLemmatizer</span>

<span class="n">lemmatizer</span> <span class="o">=</span> <span class="n">WordNetLemmatizer</span><span class="p">()</span>
<span class="n">stop_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">punctuation</span><span class="p">))</span>

<span class="n">is_valid</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stop_words</span>
<span class="n">tokenize</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
<span class="n">lemmatize</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">lemmatizer</span><span class="o">.</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;normalized&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">text</span><span class="p">:</span> <span class="p">[</span><span class="n">lemmatize</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">t</span><span class="p">)])</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(20, 3)
</pre></div></div>
</div>
<p>Words that appear only once are removed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="kn">import</span> <span class="nn">nltk</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">nltk</span><span class="o">.</span><span class="n">FreqDist</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">normalized</span><span class="p">)))</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dist</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">dist</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span><span class="p">[</span><span class="n">dist</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">valid_tokens</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">index</span><span class="p">))</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;valid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">normalized</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">tokens</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">valid_tokens</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(20, 4)
</pre></div></div>
</div>
<section id="Topic-modeling">
<h2><span class="section-number">9.1. </span>Topic modeling<a class="headerlink" href="#Topic-modeling" title="Permalink to this heading"></a></h2>
<p>Now we will apply Latent Semantic Indexing <code class="docutils literal notranslate"><span class="pre">LSI</span></code> and Laten Dirchlet Allocation <code class="docutils literal notranslate"><span class="pre">LDA</span></code> for topic modeling.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim</span> <span class="kn">import</span> <span class="n">corpora</span>

<span class="n">dictionary</span> <span class="o">=</span> <span class="n">corpora</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">dictionary</span><span class="o">.</span><span class="n">doc2bow</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim</span> <span class="kn">import</span> <span class="n">models</span>

<span class="n">tfidf_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">TfidfModel</span><span class="p">(</span><span class="n">corpus</span><span class="p">)</span>
<span class="n">corpus_tfidf</span> <span class="o">=</span> <span class="n">tfidf_model</span><span class="p">[</span><span class="n">corpus</span><span class="p">]</span>

<span class="n">lsi_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">LsiModel</span><span class="p">(</span><span class="n">corpus_tfidf</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">corpus_lsi</span> <span class="o">=</span> <span class="n">lsi_model</span><span class="p">[</span><span class="n">corpus_tfidf</span><span class="p">]</span>

<span class="n">lda_model</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">LdaModel</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">id2word</span><span class="o">=</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">num_topics</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">corpus_lda</span> <span class="o">=</span> <span class="n">lda_model</span><span class="p">[</span><span class="n">corpus</span><span class="p">]</span>
</pre></div>
</div>
</div>
<section id="Visualize-document-vectors">
<h3><span class="section-number">9.1.1. </span>Visualize document vectors<a class="headerlink" href="#Visualize-document-vectors" title="Permalink to this heading"></a></h3>
<p>The LSI and LDA models can transform the documents into vector representation in principal component <code class="docutils literal notranslate"><span class="pre">PC</span></code> or probabilistic space, respectively. We try to visualize the documents in these spaces as a 2D visualization.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">lsi_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">]</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">corpus_lsi</span><span class="p">])</span>
<span class="n">lda_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">]</span> <span class="k">for</span> <span class="n">arr</span> <span class="ow">in</span> <span class="n">corpus_lda</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">lsi_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lsi_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;g&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">clazz</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/gensim_11_0.png" src="_images/gensim_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">lda_data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lda_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;g&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">clazz</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/gensim_12_0.png" src="_images/gensim_12_0.png" />
</div>
</div>
</section>
<section id="Print-word-to-topic-relevance">
<h3><span class="section-number">9.1.2. </span>Print word to topic relevance<a class="headerlink" href="#Print-word-to-topic-relevance" title="Permalink to this heading"></a></h3>
<p>The word importances to each topic can also be retrieved.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsi_model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(0,
  &#39;-0.641*&#34;data&#34; + -0.572*&#34;science&#34; + -0.412*&#34;python&#34; + -0.165*&#34;learning&#34; + -0.119*&#34;introduction&#34; + -0.109*&#34;business&#34; + -0.100*&#34;data-driven&#34; + -0.080*&#34;finance&#34; + -0.079*&#34;guide&#34; + -0.065*&#34;thinking&#34;&#39;),
 (1,
  &#39;-0.638*&#34;finance&#34; + -0.380*&#34;investment&#34; + -0.312*&#34;real&#34; + -0.312*&#34;estate&#34; + -0.308*&#34;dummy&#34; + -0.200*&#34;personal&#34; + -0.176*&#34;introduction&#34; + -0.145*&#34;guide&#34; + -0.117*&#34;data-driven&#34; + 0.117*&#34;data&#34;&#39;)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lda_model</span><span class="o">.</span><span class="n">print_topics</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(0,
  &#39;0.199*&#34;data&#34; + 0.170*&#34;science&#34; + 0.079*&#34;python&#34; + 0.067*&#34;finance&#34; + 0.047*&#34;practical&#34; + 0.047*&#34;data-driven&#34; + 0.043*&#34;book&#34; + 0.042*&#34;need&#34; + 0.041*&#34;learning&#34; + 0.041*&#34;know&#34;&#39;),
 (1,
  &#39;0.194*&#34;finance&#34; + 0.117*&#34;data&#34; + 0.073*&#34;investment&#34; + 0.067*&#34;guide&#34; + 0.054*&#34;dummy&#34; + 0.053*&#34;estate&#34; + 0.052*&#34;real&#34; + 0.052*&#34;science&#34; + 0.044*&#34;personal&#34; + 0.043*&#34;introduction&#34;&#39;)]
</pre></div></div>
</div>
</section>
<section id="Check-coherence">
<h3><span class="section-number">9.1.3. </span>Check coherence<a class="headerlink" href="#Check-coherence" title="Permalink to this heading"></a></h3>
<p>The two coherence measures below are <code class="docutils literal notranslate"><span class="pre">u_mass</span></code> and <code class="docutils literal notranslate"><span class="pre">c_v</span></code>. At a high level, these scores try to capture how well the words in each topic fit (co-occur) together. Better information about these scores are available at the links following.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://stats.stackexchange.com/questions/375062/how-does-topic-coherence-score-in-lda-intuitively-makes-sense">How does topic coherence score in LDA intuitively makes sense?</a></p></li>
<li><p><a class="reference external" href="https://stats.stackexchange.com/questions/406216/what-is-the-formula-for-c-v-coherence">What is the formula for c_v coherence?</a></p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.models.coherencemodel</span> <span class="kn">import</span> <span class="n">CoherenceModel</span>

<span class="n">lsi_cm</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">lsi_model</span><span class="p">,</span> <span class="n">corpus</span><span class="o">=</span><span class="n">corpus_lsi</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="s1">&#39;u_mass&#39;</span><span class="p">)</span>
<span class="n">lda_cm</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">lda_model</span><span class="p">,</span> <span class="n">corpus</span><span class="o">=</span><span class="n">corpus_lda</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="s1">&#39;u_mass&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lsi&#39;</span><span class="p">,</span> <span class="n">lsi_cm</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">lda_cm</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lsi -2.5045662415022893
lda -4.4435852671814855
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lsi_cm</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">lsi_model</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="s1">&#39;c_v&#39;</span><span class="p">)</span>
<span class="n">lda_cm</span> <span class="o">=</span> <span class="n">CoherenceModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">lda_model</span><span class="p">,</span> <span class="n">texts</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="n">coherence</span><span class="o">=</span><span class="s1">&#39;c_v&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lsi&#39;</span><span class="p">,</span> <span class="n">lsi_cm</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lda&#39;</span><span class="p">,</span> <span class="n">lda_cm</span><span class="o">.</span><span class="n">get_coherence</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lsi 0.5731227064090376
lda 0.5731227064090375
</pre></div></div>
</div>
</section>
<section id="Check-clustering-quality">
<h3><span class="section-number">9.1.4. </span>Check clustering quality<a class="headerlink" href="#Check-clustering-quality" title="Permalink to this heading"></a></h3>
<p>The silhouette score can evaluate the clustering quality without the truth labels, while the rand score will evaluate the clustering quality with the truth labels. For both these scores, a higher value is better.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_score</span><span class="p">,</span> <span class="n">rand_score</span>

<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">lsi_data</span><span class="p">)</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">lsi_data</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">ran_score</span> <span class="o">=</span> <span class="n">rand_score</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">clazz</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;silhouette: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">, rand: </span><span class="si">{</span><span class="n">ran_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
silhouette: 0.58734, rand: 1.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">lda_data</span><span class="p">)</span>
<span class="n">sil_score</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">lsi_data</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>
<span class="n">ran_score</span> <span class="o">=</span> <span class="n">rand_score</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">clazz</span><span class="p">,</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;silhouette: </span><span class="si">{</span><span class="n">sil_score</span><span class="si">:</span><span class="s1">.5f</span><span class="si">}</span><span class="s1">, rand: </span><span class="si">{</span><span class="n">ran_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
silhouette: 0.54072, rand: 0.8105263157894737
</pre></div></div>
</div>
</section>
</section>
<section id="word2vec">
<h2><span class="section-number">9.2. </span>word2vec<a class="headerlink" href="#word2vec" title="Permalink to this heading"></a></h2>
<p>Word2vec <code class="docutils literal notranslate"><span class="pre">w2v</span></code> is an approach to vectorize words such that in the vector space, words that have similar meaning will be closer algebraically. These vectors are often called <code class="docutils literal notranslate"><span class="pre">embeddings</span></code>. The field has matured to the point where embeddings may be created for all sorts of data (not only text but also images). For example, there are also sentence, paragraph and document embeddings techniques.</p>
<p>Below, we learn word embeddings for the book titles. The number of iterations <code class="docutils literal notranslate"><span class="pre">iter</span></code> is set to a very high number to get some stability.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.test.utils</span> <span class="kn">import</span> <span class="n">datapath</span>
<span class="kn">from</span> <span class="nn">gensim</span> <span class="kn">import</span> <span class="n">utils</span>

<span class="k">class</span> <span class="nc">BookTitleCorpus</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">titles</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">title</span> <span class="ow">in</span> <span class="n">titles</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">title</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.models</span> <span class="kn">import</span> <span class="n">Word2Vec</span>

<span class="n">w2v_model</span> <span class="o">=</span> <span class="n">Word2Vec</span><span class="p">(</span><span class="o">**</span><span class="p">{</span>
    <span class="s1">&#39;sentences&#39;</span><span class="p">:</span> <span class="n">BookTitleCorpus</span><span class="p">(),</span>
    <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;min_count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;negative&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;iter&#39;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
    <span class="s1">&#39;compute_loss&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;hs&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;sg&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="mi">37</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<p>All the words that can be mapped to an embedding is access through the <code class="docutils literal notranslate"><span class="pre">wv.index2word</span></code> property.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">index2word</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;data&#39;,
 &#39;finance&#39;,
 &#39;science&#39;,
 &#39;python&#39;,
 &#39;guide&#39;,
 &#39;investment&#39;,
 &#39;business&#39;,
 &#39;need&#39;,
 &#39;know&#39;,
 &#39;thinking&#39;,
 &#39;practical&#39;,
 &#39;data-driven&#39;,
 &#39;learning&#39;,
 &#39;introduction&#39;,
 &#39;book&#39;,
 &#39;personal&#39;,
 &#39;dummy&#39;,
 &#39;real&#39;,
 &#39;estate&#39;]
</pre></div></div>
</div>
<p>You may retrieve the vector for each word as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([ 0.593597  , -0.25675973, -0.25700533, -0.09834253,  1.0051605 ],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="s1">&#39;science&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.07897905,  0.13377394, -0.53072256, -0.42197725,  0.75260234],
      dtype=float32)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="p">[</span><span class="s1">&#39;finance&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([-0.0450182 , -0.7350258 ,  0.03632208,  0.88822436, -0.7655971 ],
      dtype=float32)
</pre></div></div>
</div>
<p>You can also query for similary words.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;business&#39;, 0.871295154094696), (&#39;science&#39;, 0.6787357926368713), (&#39;learning&#39;, 0.6179041266441345), (&#39;thinking&#39;, 0.6133607625961304), (&#39;need&#39;, 0.5080872178077698), (&#39;know&#39;, 0.5036865472793579), (&#39;guide&#39;, 0.37261903285980225), (&#39;python&#39;, 0.3343797028064728), (&#39;practical&#39;, 0.15768414735794067), (&#39;book&#39;, 0.09061828255653381)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;science&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;data&#39;, 0.6787357926368713), (&#39;practical&#39;, 0.6711301207542419), (&#39;book&#39;, 0.5050278902053833), (&#39;business&#39;, 0.48344868421554565), (&#39;know&#39;, 0.335382342338562), (&#39;guide&#39;, 0.32071053981781006), (&#39;learning&#39;, 0.28909873962402344), (&#39;thinking&#39;, 0.27567052841186523), (&#39;python&#39;, 0.24710051715373993), (&#39;need&#39;, 0.22812509536743164)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">w2v_model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">positive</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;finance&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[(&#39;personal&#39;, 0.8275710344314575), (&#39;real&#39;, 0.739374041557312), (&#39;estate&#39;, 0.7324811220169067), (&#39;investment&#39;, 0.6838704347610474), (&#39;dummy&#39;, 0.5812346339225769), (&#39;need&#39;, 0.41558361053466797), (&#39;guide&#39;, 0.3766511082649231), (&#39;thinking&#39;, 0.3643118143081665), (&#39;know&#39;, 0.3500431776046753), (&#39;introduction&#39;, 0.04492002725601196)]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">reduce_dimensions</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">num_dimensions</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">vectors</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">wv</span><span class="o">.</span><span class="n">index2word</span><span class="p">)</span>

    <span class="n">tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">num_dimensions</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">vectors</span> <span class="o">=</span> <span class="n">tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span>

    <span class="n">x_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">]</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">vectors</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">labels</span>


<span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">reduce_dimensions</span><span class="p">(</span><span class="n">w2v_model</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>

<span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
<span class="n">selected_indices</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">selected_indices</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">x_vals</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/gensim_35_0.png" src="_images/gensim_35_0.png" />
</div>
</div>
</section>
<section id="doc2vec">
<h2><span class="section-number">9.3. </span>doc2vec<a class="headerlink" href="#doc2vec" title="Permalink to this heading"></a></h2>
<p>Doc2vec <code class="docutils literal notranslate"><span class="pre">d2v</span></code> creates vectors over documents. Take note of the <code class="docutils literal notranslate"><span class="pre">epochs</span></code> required for training to get stability.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gensim.models.doc2vec</span> <span class="kn">import</span> <span class="n">TaggedDocument</span><span class="p">,</span> <span class="n">Doc2Vec</span>

<span class="k">def</span> <span class="nf">read_corpus</span><span class="p">(</span><span class="n">tokens_only</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tokens</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">tokens_only</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">tokens</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">TaggedDocument</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">tr_corpus</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">read_corpus</span><span class="p">())</span>
<span class="n">te_corpus</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">read_corpus</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>

<span class="n">d2v_model</span> <span class="o">=</span> <span class="n">Doc2Vec</span><span class="p">(</span><span class="n">vector_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
<span class="n">d2v_model</span><span class="o">.</span><span class="n">build_vocab</span><span class="p">(</span><span class="n">tr_corpus</span><span class="p">)</span>
<span class="n">d2v_model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">tr_corpus</span><span class="p">,</span> <span class="n">total_examples</span><span class="o">=</span><span class="n">d2v_model</span><span class="o">.</span><span class="n">corpus_count</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">d2v_model</span><span class="o">.</span><span class="n">epochs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After the d2v model is trained, you can infer the vectors for any text.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vector</span> <span class="o">=</span> <span class="n">d2v_model</span><span class="o">.</span><span class="n">infer_vector</span><span class="p">(</span><span class="s1">&#39;data science is cool&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-1.9255836  -0.02223318  0.2743532   2.352567    0.43010306]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vector</span> <span class="o">=</span> <span class="n">d2v_model</span><span class="o">.</span><span class="n">infer_vector</span><span class="p">(</span><span class="s1">&#39;science is cool&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[-1.1838392 -0.654592   1.0636024  2.6199558  0.5647269]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vector</span> <span class="o">=</span> <span class="n">d2v_model</span><span class="o">.</span><span class="n">infer_vector</span><span class="p">(</span><span class="s1">&#39;finance is cool&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[2.0806925  2.0674143  1.0229923  0.81294686 0.76004183]
</pre></div></div>
</div>
<p>Below is diagnostic code to see if a document is similar to itself. The results show that most times, a document is most similar to itself. This process is not deterministic and different runs will generate different results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">ranks</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">doc_id</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tr_corpus</span><span class="p">)):</span>
    <span class="n">inferred_vector</span> <span class="o">=</span> <span class="n">d2v_model</span><span class="o">.</span><span class="n">infer_vector</span><span class="p">(</span><span class="n">tr_corpus</span><span class="p">[</span><span class="n">doc_id</span><span class="p">]</span><span class="o">.</span><span class="n">words</span><span class="p">)</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">d2v_model</span><span class="o">.</span><span class="n">docvecs</span><span class="o">.</span><span class="n">most_similar</span><span class="p">([</span><span class="n">inferred_vector</span><span class="p">],</span> <span class="n">topn</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">d2v_model</span><span class="o">.</span><span class="n">docvecs</span><span class="p">))</span>
    <span class="n">rank</span> <span class="o">=</span> <span class="p">[</span><span class="n">docid</span> <span class="k">for</span> <span class="n">docid</span><span class="p">,</span> <span class="n">sim</span> <span class="ow">in</span> <span class="n">sims</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">doc_id</span><span class="p">)</span>
    <span class="n">ranks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">ranks</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Counter({0: 18, 1: 2})
</pre></div></div>
</div>
</section>
<section id="Word-mover's-distance">
<h2><span class="section-number">9.4. </span>Word mover’s distance<a class="headerlink" href="#Word-mover's-distance" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gensim.downloader</span> <span class="k">as</span> <span class="nn">api</span>

<span class="n">wm_model1</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;word2vec-google-news-300&#39;</span><span class="p">)</span>

<span class="n">wm_model2</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;word2vec-google-news-300&#39;</span><span class="p">)</span>
<span class="n">wm_model2</span><span class="o">.</span><span class="n">init_sims</span><span class="p">(</span><span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">docs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">valid</span><span class="p">)</span>
<span class="n">distances1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">distances2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">docs</span><span class="p">)):</span>
    <span class="n">d1</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">wm_model1</span><span class="o">.</span><span class="n">wmdistance</span><span class="p">(</span><span class="n">docs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">docs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">docs</span><span class="p">))}</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="n">wm_model2</span><span class="o">.</span><span class="n">wmdistance</span><span class="p">(</span><span class="n">docs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">docs</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">docs</span><span class="p">))}</span>

    <span class="n">distances1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d1</span><span class="p">)</span>
    <span class="n">distances2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>

<span class="n">dist_df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">distances1</span><span class="p">)</span>
<span class="n">dist_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">distances1</span><span class="p">)</span>

<span class="n">dist_df1</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">docs</span><span class="p">))]</span>
<span class="n">dist_df2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;d</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">docs</span><span class="p">))]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">dist_df1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Greens&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">dist_df2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;Greens&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Doc Similarities&#39;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Doc Similarities (normalized)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/gensim_46_0.png" src="_images/gensim_46_0.png" />
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nltk.html" class="btn btn-neutral float-left" title="8. NLTK" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pyod.html" class="btn btn-neutral float-right" title="10. PyOD, Anamoly Detection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, One-Off Coder.
      <span class="lastupdated">Last updated on Apr 03, 2024, 4:32:27 PM.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-150760969-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-150760969-1', {
          'anonymize_ip': false,
      });
    </script>
 
<script async type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://" : "http://");
  document.write(unescape("%3Cscript src='" + gaJsHost + "www.googletagmanager.com/gtag/js?id=UA-150760969-1' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-150760969-1');
  } catch(err) {}</script>


</body>
</html>